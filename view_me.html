<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Domain JSON Viewer</title>
    <style>
        :root {
            --bg-color: #ffffff;
            --text-color: #333333;
            --header-color: #333333;
            --border-color: #dddddd;
            --table-header-bg: #f2f2f2;
            --table-header-text: #000000;
            --empty-color: #888888;
            --error-color: #ff0000;
            --link-color: #0066cc;
        }
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            line-height: 1.6; 
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: background-color 0.3s, color 0.3s;
        }
        h1, h2 { color: var(--header-color); }
        table { border-collapse: collapse; width: 10%; margin-bottom: 20px; }
        th, td { border: 0px solid var(--border-color); padding: 8px; text-align: left; }
        th { background-color: var(--table-header-bg); color: var(--table-header-text); }
        ul { list-style-type: disc; padding-left: 20px; }
        .section { margin-bottom: 30px; }
        .empty { font-style: italic; color: var(--empty-color); }
        #fileInput { margin-bottom: 20px; }
        .error { color: var(--error-color); font-weight: bold; }
        a { color: var(--link-color); text-decoration: none; }
        a:hover { text-decoration: underline; }
        
        /* Dark Mode */
        body.dark-mode {
            --bg-color: #1e1e1e;
            --text-color: #dddddd;
            --header-color: #ffffff;
            --border-color: #444444;
            --table-header-bg: #333333;
            --table-header-text: #ffffff;
            --empty-color: #888888;
            --error-color: #ff6b6b;
            --link-color: #4da6ff;
        }
        
        /* Toggle Switch Styles */
        .theme-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
            margin-bottom: 20px;
        }
        .theme-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: 0.4s;
            border-radius: 34px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: 0.4s;
            border-radius: 50%;
        }
        input:checked + .slider {
            background-color: #2196F3;
        }
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        .theme-switch label {
            margin-left: 10px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>Sir Jimbet sub-domain Information Viewer # <a target='_blank' href='https://github.com/jimbet/'>Sir Jimbet - GitHub</a></h1>
    <P>&nbsp;</P>
	
	<table>
	<tr>
        <td size="H2">View Mode:&nbsp;&nbsp;<label class="theme-switch"><input type="checkbox" id="darkModeToggle"><span class="slider"></span></label></td>
	</tr>
	</table>
	
    <P>&nbsp;</P>
    <div id="fileInput">
        <label for="jsonFile">Choose JSON File:</label>
        <input type="file" name="JSON File" id="jsonFile" accept=".json" size="50"/>
    </div>
    
    <div id="output">
        <p>Select a JSON file to parse and view its data.</p>
    </div>

    <script>
        // Theme Toggle Functionality
        const darkModeToggle = document.getElementById('darkModeToggle');
        const body = document.body;
        
        // Check for saved theme preference or default to light
        const savedTheme = localStorage.getItem('theme') || 'light';
        if (savedTheme === 'dark') {
            body.classList.add('dark-mode');
            darkModeToggle.checked = true;
        }
        
        darkModeToggle.addEventListener('change', function() {
            if (this.checked) {
                body.classList.add('dark-mode');
                localStorage.setItem('theme', 'dark');
            } else {
                body.classList.remove('dark-mode');
                localStorage.setItem('theme', 'light');
            }
        });

        const fileInput = document.getElementById('jsonFile');
        const output = document.getElementById('output');

        fileInput.addEventListener('change', function(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const jsonData = JSON.parse(e.target.result);

                    // Validate required keys
                    if (!jsonData.domain || !jsonData.subdomains || !jsonData.dns_info) {
                        throw new Error('JSON structure invalid: Missing required keys (domain, subdomains, dns_info).');
                    }

                    // Clear previous content
                    output.innerHTML = '';

                    // Overview
                    output.innerHTML += `
                        <div id="overview" class="section">
                            <h2>Overview</h2>
                            <p><strong>Domain:</strong> ${jsonData.domain}</p>
                            <p><strong>DNS Server:</strong> ${jsonData.dns_server || 'N/A'}</p>
                            <p><strong>Resolver:</strong> ${jsonData.resolver || 'N/A'}</p>
                            <p><strong>Total Subdomains:</strong> ${jsonData.total_subdomains || 'N/A'}</p>
                            <p><strong>Total Unique IPs:</strong> ${jsonData.total_unique_ips || 'N/A'}</p>
                        </div>
                    `;

                    // Subdomains Table
                    let subHtml = '<div id="subdomains" class="section"><h2>Subdomains</h2><table><tr><th>Subdomain</th><th>IPs</th></tr>';
                    Object.entries(jsonData.subdomains || {}).forEach(([sub, ips]) => {
                        subHtml += `<tr><td>${sub}</td><td>${Array.isArray(ips) ? ips.join(', ') : 'N/A'}</td></tr>`;
                    });
                    subHtml += '</table></div>';
                    output.innerHTML += subHtml;

                    // IP Groups Table
                    let ipHtml = '<div id="ip_groups" class="section"><h2>IP Groups</h2><table><tr><th>IP</th><th>Subdomains</th></tr>';
                    Object.entries(jsonData.ip_groups || {}).forEach(([ip, subs]) => {
                        ipHtml += `<tr><td>${ip}</td><td>${Array.isArray(subs) ? subs.join(', ') : 'N/A'}</td></tr>`;
                    });
                    ipHtml += '</table></div>';
                    output.innerHTML += ipHtml;

                    // Shared IPs Table
                    let sharedHtml = '<div id="shared_ips" class="section"><h2>Shared IPs</h2><table><tr><th>IP</th><th>Subdomains</th></tr>';
                    Object.entries(jsonData.shared_ips || {}).forEach(([ip, subs]) => {
                        sharedHtml += `<tr><td>${ip}</td><td>${Array.isArray(subs) ? subs.join(', ') : 'N/A'}</td></tr>`;
                    });
                    sharedHtml += '</table></div>';
                    output.innerHTML += sharedHtml;

                    // DNS Info
                    const dnsInfo = jsonData.dns_info;
                    let dnsHtml = '<div id="dns_info" class="section"><h2>DNS Information</h2>';
                    dnsHtml += `<p><strong>Domain:</strong> ${dnsInfo.domain}</p>`;
                    
                    dnsHtml += '<h3>Nameservers</h3><ul>';
                    (dnsInfo.nameservers || []).forEach(ns => dnsHtml += `<li>${ns}</li>`);
                    dnsHtml += '</ul>';
                    
                    dnsHtml += '<h3>A Records</h3><ul>';
                    (dnsInfo.a_records || []).forEach(a => dnsHtml += `<li>${a}</li>`);
                    dnsHtml += '</ul>';
                    
                    if ((dnsInfo.aaaa_records || []).length === 0) {
                        dnsHtml += '<h3>AAAA Records</h3><p class="empty">None</p>';
                    } else {
                        dnsHtml += '<h3>AAAA Records</h3><ul>';
                        (dnsInfo.aaaa_records || []).forEach(aaaa => dnsHtml += `<li>${aaaa}</li>`);
                        dnsHtml += '</ul>';
                    }
                    
                    dnsHtml += '<h3>MX Records</h3><table><tr><th>Priority</th><th>Host</th></tr>';
                    (dnsInfo.mx_records || []).forEach(mx => {
                        dnsHtml += `<tr><td>${mx.priority || 'N/A'}</td><td>${mx.host || 'N/A'}</td></tr>`;
                    });
                    dnsHtml += '</table>';
                    
                    dnsHtml += '<h3>TXT Records</h3><ul>';
                    (dnsInfo.txt_records || []).forEach(txt => dnsHtml += `<li>${txt}</li>`);
                    dnsHtml += '</ul>';
                    
                    dnsHtml += '<h3>SOA Record</h3>';
                    const soa = dnsInfo.soa_record || {};
                    dnsHtml += `<p><strong>MName:</strong> ${soa.mname || 'N/A'}</p>`;
                    dnsHtml += `<p><strong>RName:</strong> ${soa.rname || 'N/A'}</p>`;
                    dnsHtml += `<p><strong>Serial:</strong> ${soa.serial || 'N/A'}</p>`;
                    dnsHtml += `<p><strong>Refresh:</strong> ${soa.refresh || 'N/A'}</p>`;
                    dnsHtml += `<p><strong>Retry:</strong> ${soa.retry || 'N/A'}</p>`;
                    dnsHtml += `<p><strong>Expire:</strong> ${soa.expire || 'N/A'}</p>`;
                    dnsHtml += `<p><strong>Minimum:</strong> ${soa.minimum || 'N/A'}</p>`;
                    
                    dnsHtml += `<h3>SPF Record</h3><p>${dnsInfo.spf_record || 'N/A'}</p>`;
                    dnsHtml += `<h3>DMARC Record</h3><p>${dnsInfo.dmarc_record || 'N/A'}</p>`;
                    
                    if ((dnsInfo.caa_records || []).length === 0) {
                        dnsHtml += '<h3>CAA Records</h3><p class="empty">None</p>';
                    } else {
                        dnsHtml += '<h3>CAA Records</h3><ul>';
                        (dnsInfo.caa_records || []).forEach(caa => dnsHtml += `<li>${caa}</li>`);
                        dnsHtml += '</ul>';
                    }
                    
                    if ((dnsInfo.srv_records || []).length === 0) {
                        dnsHtml += '<h3>SRV Records</h3><p class="empty">None</p>';
                    } else {
                        dnsHtml += '<h3>SRV Records</h3><ul>';
                        (dnsInfo.srv_records || []).forEach(srv => dnsHtml += `<li>${JSON.stringify(srv)}</li>`);
                        dnsHtml += '</ul>';
                    }
                    
                    dnsHtml += '</div>';
                    output.innerHTML += dnsHtml;

                } catch (error) {
                    output.innerHTML = `<p class="error">Error parsing JSON: ${error.message}</p>`;
                }
            };
            reader.readAsText(file);
        });
    </script>
</body>
</html>
